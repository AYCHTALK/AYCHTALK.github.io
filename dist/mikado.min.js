/**
 * Mikado.js v0.1.3
 * Copyright 2019 Nextapps GmbH
 * Author: Thomas Wilkerling
 * Licence: Apache-2.0
 * https://github.com/nextapps-de/mikado
 */
(function(){'use strict';var k;function l(a,b,d,c){window[(a?"add":"remove")+"EventListener"](b,d,c||{passive:!0,capture:!0})}function u(a,b){b||(b=a.type);var d=a.target,c=d,e=d["_e_"+b];if(e)c=d["_r_"+b];else{for(;c;){if(c===x)return;if(e=c.getAttribute(b)){if(-1!==e.indexOf(":")){var g=e.split(":"),h=g[1];e=0;for(c=c.parentElement;c!==x;){if(c.hasAttribute(h)){e=g[0];break}c=c.parentElement}}break}c=c.parentElement}if(!e)return;d["_e_"+b]=e;d["_r_"+b]=c}if(b=y[e])a.preventDefault(),b(c,a,d);a.stopPropagation()}
var B={},y={},x=document.body;C.prototype.route=function(a,b){y[a]=b;return this};var D="ontouchstart"in window||navigator.msMaxTouchPoints,E,F,G;if(D){var H=function(a,b){b&&(b=b[0]);E=b?b.clientX:a.pageX;F=b?b.clientY:a.pageY},I=function(a){var b=E,d=F;H(a,a.changedTouches);50>Math.abs(E-b)&&50>Math.abs(F-d)&&u.call(this,a,"click")},K=function(a){H(a,a.touches)};G=function(a){l(a,"touchstart",K,!1);l(a,"touchend",I,!1)}}
C.prototype.listen=function(a,b){B[a]||(D&&"click"===a?G(1):l(1,a,u,b||!0),B[a]=1);return this};C.prototype.unlisten=function(a,b){B[a]&&(D&&"click"===a?G(0):l(0,a,u,b||!0),B[a]=0);return this};k=C.prototype;k.up=function(a){if(a=a._i){var b=this.b[a],d=this.b[a-1];this.root.insertBefore(b,d);b._i=a-1;d._i=a;this.b[a]=d;this.b[a-1]=b;this.store&&(b=this.store[a-1],this.store[a-1]=this.store[a],this.store[a]=b)}};k.down=function(a){a=a._i;if(a<this.length-1){var b=this.b[a],d=this.b[a+1];a===this.length-2?this.root.appendChild(b):this.root.insertBefore(b,d);b._i=a+1;d._i=a;this.b[a]=d;this.b[a+1]=b;this.store&&(b=this.store[a+1],this.store[a+1]=this.store[a],this.store[a]=b)}};
k.first=function(a){var b=a._i;if(b){this.root.insertBefore(a,this.b[0]);a=this.b.splice(b,1)[0];this.b.unshift(a);for(a=0;a<=b;a++)this.b[a]._i=a;this.store&&(b=this.store.splice(b,1)[0],this.store.unshift(b))}};k.last=function(a){var b=a._i;if(b<this.length-1){this.root.appendChild(a);a=this.b.splice(b,1)[0];this.b.push(a);for(a=b;a<this.length;a++)this.b[a]._i=a;this.store&&(b=this.store.splice(b,1)[0],this.store.push(b))}};
k.swap=function(a,b){if(a!==b){if("number"===typeof a){var d=a;a=this.b[a]}else d=a._i;if("number"===typeof b){var c=b;b=this.b[b]}else c=b._i;if(this.B){var e=a._m;this.update(a,b._m,null,c);this.update(b,e,null,d)}else this.root.insertBefore(a,b),this.root.insertBefore(b,d+1===c?a:this.b[d+1]),a._i=c,b._i=d,this.b[d]=b,this.b[c]=a;this.store&&(a=this.store[c],this.store[c]=this.store[d],this.store[d]=a)}return this};var L=window.localStorage;C.prototype.export=function(){if(this.store)var a=this.store;else if(this.o){a=Array(this.length);for(var b=0;b<this.length;b++)a[b]=this.b[b]._m}a&&L.setItem(this.u,JSON.stringify(a));return this};C.prototype.import=function(){var a=L.getItem(this.u);a&&(a=JSON.parse(a),this.A?this.store.push.apply(this.store,a):this.store=a);return this};var M=window,N=M.requestAnimationFrame,O=M.cancelAnimationFrame,P={store:!1,loose:!0,async:!1,reuse:!0},Q={},R={};function C(a,b,d){a.nodeType||(d=b,b=a,a=null);b||(d=a);a?this.mount(a):(this.root=this.b=null,this.length=0);this.init(b,d)}var S=C.register=function(a,b){b||(b=a,a=b.n);R[a]=b;return C};C.new=function(a,b,d){return new C(a,b,d)};C.prototype.mount=function(a){this.root!==a&&(this.root=a,T(this),this.b=a._d||(a._d=U(a.children)),this.length=this.b.length);return this};
var V={tap:1,change:1,click:1,dblclick:1,input:1,keydown:1,keypress:1,keyup:1,mousedown:1,mouseenter:1,mouseleave:1,mousemove:1,mouseout:1,mouseover:1,mouseup:1,mousewheel:1,touchstart:1,touchmove:1,touchend:1,touchcancel:1,reset:1,select:1,submit:1,toggle:1,blur:1,error:1,focus:1,load:1,resize:1,scroll:1};k=C.prototype;k.sync=function(){this.root._d=this.b=U(this.root.children);this.length=this.b.length;return this};k.index=function(a){return a._i};k.node=function(a){return this.b[a]};
k.item=function(a){return this.o?this.b[a]._m:this.store[a]};k.init=function(a,b){this.C=b=b?Object.assign({},this.C||P,b):P;"string"===typeof a?a=R[a]:S(a);this.async=b.async;this.B=b.reuse;this.state=b.state||Q;var d=b.store;d?(this.o=b.loose)?this.store=!1:(this.A="object"===typeof d,this.store=d&&(this.A?d:[])):this.o=this.store=!1;this.u!==a&&(this.u=a.n,this.w=this.g=null,this.l=!0,this.v=null,this.D=W(this,a),T(this));b.once&&this.render().destroy(!0);return this};
function T(a){if(a.root){var b=a.root._t;b!==a.u&&(a.root._t=a.u,b&&a.clear())}}function U(a){for(var b=a.length,d=Array(b),c=0,e;c<b;c++)e=a[c],e._i=c,d[c]=e;return d}k.create=function(a,b,d){var c=this.D;this.l||this.w(c._p,c._m,a,d,b);return c.cloneNode(!0)};
k.refresh=function(a){if("number"===typeof a){var b=this.b[a];return this.update(b,this.storage?this.store[a]:b._m,null,a)}var d=(b=this.store)?b.length:this.o?this.length:0;this.o&&(this.store=null);for(var c=0;c<d;c++)this.update(this.b[c],b?b[c]:null,a,c);return this};var X;k=C.prototype;
k.render=function(a,b,d,c){"function"===typeof b&&(d=b,b=null);if(!c){if(d){var e=this;X=N(function(){X=null;e.render(a,b,null,!0);"function"===typeof d&&d()});return this}if(this.async){var g=this;return new Promise(function(m){X=N(function(){X=null;g.render(a,b,null,!0);m()})})}}if(this.l)this.b[0]||this.add();else if(a||this.o){c=a?a.length:this.length;if(!c)return this.clear();this.B||this.clear(c);for(var h=0;h<c;h++)h<this.length?this.update(this.b[h],a[h],b,h):this.add(a[h],b,this.root);if(c<
this.length){this.store&&this.store.splice(c);h=this.b.splice(c);this.length=c;c=h.length;for(var q=0;q<c;q++)this.root.removeChild(h[q])}}return this};k.add=function(a,b,d){var c=this.length;b=this.create(a,b,c);this.store?this.store[c]=a:this.o&&(b._m=a);b._i=c;(d||this.root).appendChild(b);this.b[c]=b;this.length++;return this};k.clear=function(a){this.root._d=this.b=a?Array(a):[];this.root.textContent="";this.length=0;this.store&&(this.A?this.store.splice(0):this.store=a?Array(a):[]);return this};
k.destroy=function(a){a&&this.unload();this.D=this.w=this.g=this.root=this.b=null};k.cancel=function(){X&&(O(X),X=null)};k.append=function(a,b){for(var d=a.length,c=0;c<d;c++)this.add(a[c],b);return this};k.remove=function(a){var b=a._i;this.b.splice(b,1);this.root.removeChild(a);this.length--;this.store&&this.store.splice(b,1);for(a=b;a<this.length;a++)this.b[a]._i=a;return this};
k.replace=function(a,b,d,c){"undefined"===typeof c&&(c=a._i);d=this.create(b,d,c);this.store?this.store[c]=b:this.o&&(d._m=b);d._i=c;this.root.replaceChild(d,a);this.b[c]=d;return this};k.update=function(a,b,d,c){this.store?this.store[c]=b:this.o&&(a._m=b);this.w(a._p||aa(this,a),a._m,b,c,d);return this};
function aa(a,b){for(var d=a.g.length,c={},e=Array(d),g=0;g<d;g++){var h=a.g[g],q=g,m;if(!(m=c[h])){m=b;for(var r="",v=0;v<h.length;v++){var n=h[v];r+=n;c[r]?m=c[r]:(">"===n?m=m.firstElementChild:"+"===n?m=m.nextElementSibling:"|"===n&&(m=m.firstChild),c[r]=m)}}e[q]=m}b._p=e;b._m={};return e}var Y;
function W(a,b,d,c,e){var g=document.createElement(b.t||"div");d||(d=0,c="&",Y="",a.g=[],g._p=e=[],g._m={});var h=b.s,q=b.i,m=b.x,r=b.h,v=b.a,n=b.c,w=b.j,f=a.g.length,p=0,t="";w&&(t+=w+";",p=2);n&&("object"===typeof n?(t+=";v="+n[0]+";if(s._c"+f+"!==v){s._c"+f+"=v;self.className=v;}",a.g[f]=c,e[f]=g,a.l=!1,p++):g.className=n);if(v){n=Object.keys(v);for(w=0;w<n.length;w++){var z=n[w],J=v[z];if("object"===typeof J){t+=";v="+J[0]+";if(s['_a_"+z+f+"']!==v){s['_a_"+z+f+"']=v;self.setAttribute('"+z+"',v);}";
var A=!0;p++}else g.setAttribute(z,J);V[z]&&a.listen(z)}A&&(a.g[f]=c,e[f]=g,a.l=!1)}if(h)if("string"===typeof h)g.style.cssText=h;else if(h.length)t+=";v="+h[0]+";if(s._cs"+f+"!==v){s._cs"+f+"=v;self.style.cssText=v;}",a.g[f]=c,e[f]=g,a.l=!1,p++;else{v=Object.keys(h);for(A=0;A<v.length;A++)if(n=v[A],w=h[n],"object"===typeof w){t+=";v="+w[0]+";if(s['_s_"+n+f+"']!==v){s['_s_"+n+f+"']=v;self.style.setProperty('"+n+"',v);}";var ba=!0;p++}else g.style.setProperty(n,w);ba&&(a.g[f]=c,e[f]=g,a.l=!1)}q||(b["@"]?
(a.v||(a.v=[]),m=Y+="this.include["+a.v.length+"].mount(p["+f+"]).render("+b.r+(b.m?".slice("+(0<b.m?"0,":"")+b.m+")":"")+",index,view);",Y="",a.v.push(new C(g,"string"===typeof b["@"]?R[b["@"]]:b["@"],a.C)),Y=m,a.g[f]=c,e[f]=g,a.l=!1):b["+"]?q=R[b["+"]]:m?(c+="|",(h="object"===typeof m)&&(m=m[0]),r=document.createTextNode(m),h&&(e[f]&&(Z(p,t,f),t="",f++),t+=";v="+m+";if(s._x"+f+"!==v){s._x"+f+"=v;self.nodeValue=v;};",a.g[f]=c,e[f]=r,a.l=!1,p++),g.appendChild(r)):r&&("object"===typeof r?(r=r[0],t+=
"self.innerHTML="+r+";",a.g[f]=c,e[f]=g,a.l=!1,p++):g.innerHTML=r));b.f&&(Y+=";if("+b.f+"){"+(1<p?"self":"p["+f+"]")+".hidden=false;",p||(a.g[f]=c,e[f]=g,a.l=!1));Z(p,t,f);b.f&&(Y+="}else "+(1<p?"self":"p["+f+"]")+".hidden=true;");if(q)if(q.length)for(f=">",p=0;p<q.length;p++){p&&(f+="+");t=q[p];if(b=t["+"])t=R[b];g.appendChild(W(a,t,d+p+1,c+f,e))}else{if(b=q["+"])q=R[b];g.appendChild(W(a,q,d+1,c+">",e))}d||a.l||(a.w=Function("p","s","item","index","view",Y?'"use strict";var self,v'+Y+";":""));return g}
function Z(a,b,d){a&&(a?(Y+=";self=p["+d+"];",Y+=b):Y+=b.replace(/self/g,"p["+d+"]"))}C.prototype.load=function(a,b){if(R[a])this instanceof C&&this.init(R[a]),b&&b();else{var d=this,c=new XMLHttpRequest;c.overrideMimeType("application/json");c.open("GET",a,!1!==b);c.onload=function(){var e=this.responseText;if(e){try{var g=JSON.parse(e);S(g);d instanceof C&&d.init(g)}catch(q){var h=q}"function"===typeof b&&b(h)}};c.send()}};C.load=C.prototype.load;
C.prototype.unload=function(a){a||(a=this.u);a&&(R[a]=null)};C.unload=C.prototype.unload;(function(){var a=this||window,b;(b=a.define)&&b.amd?b([],function(){return C}):(b=a.modules)?b.mikado=C:"object"===typeof a.exports?a.module.exports=C:a.Mikado=C})();}).call(this);
