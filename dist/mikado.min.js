/**
 * Mikado.js v0.3.0
 * Copyright 2019 Nextapps GmbH
 * Author: Thomas Wilkerling
 * Licence: Apache-2.0
 * https://github.com/nextapps-de/mikado
 */
(function(){'use strict';var h;function l(a,b,d,c){window[(a?"add":"remove")+"EventListener"](b,d,c||{passive:!0,capture:!0})}function x(a,b){b||(b=a.type);var d=a.target,c=d,e=d["_e_"+b];if(e)c=d["_r_"+b];else{for(;c;){if(c===z)return;if(e=c.getAttribute(b)){if(-1!==e.indexOf(":")){var f=e.split(":"),g=f[1];e=0;for(c=c.parentElement;c!==z;){if(c.hasAttribute(g)){e=f[0];break}c=c.parentElement}}break}c=c.parentElement}if(!e)return;d["_e_"+b]=e;d["_r_"+b]=c}if(b=C[e])a.preventDefault(),b(c,a,d);a.stopPropagation()}
var D={},C={},z=document.body;E.prototype.route=function(a,b){C[a]=b;return this};var F="ontouchstart"in window||navigator.msMaxTouchPoints,G,H,I;if(F){var J=function(a,b){b&&(b=b[0]);G=b?b.clientX:a.pageX;H=b?b.clientY:a.pageY},K=function(a){var b=G,d=H;J(a,a.changedTouches);50>Math.abs(G-b)&&50>Math.abs(H-d)&&x.call(this,a,"click")},L=function(a){J(a,a.touches)};I=function(a){l(a,"touchstart",L,!1);l(a,"touchend",K,!1)}}
E.prototype.listen=function(a,b){D[a]||(F&&"click"===a?I(1):l(1,a,x,b||!0),D[a]=1);return this};E.prototype.unlisten=function(a,b){D[a]&&(F&&"click"===a?I(0):l(0,a,x,b||!0),D[a]=0);return this};h=E.prototype;h.move=function(a,b){if("number"===typeof a){var d=a;a=this.b[a]}else d=a._i;0>b&&(b=this.length+b-1);d!==b&&this.shift(a,b-d);return this};
h.shift=function(a,b){if(!b)return this;if("number"===typeof a){var d=a;a=this.b[a]}else d=a._i;var c=0>b;if(c&&d||!c&&d<this.length-1){b=c?Math.max(d+b,0):Math.min(d+b,this.length-1);var e=this.b[b];c?this.root.insertBefore(a,e):b===this.length-1?this.root.appendChild(a):this.root.insertBefore(a,this.b[b+1]);if(c&&1<d-b||!c&&1<b-d){e=this.b[d];a=this.store&&this.store[d];if(c)for(c=d;c>b;c--)d=this.b[c]=this.b[c-1],d._i=c,this.store&&(this.store[c]=this.store[c-1]);else for(c=d;c<b;c++)d=this.b[c]=
this.b[c+1],d._i=c,this.store&&(this.store[c]=this.store[c+1]);d=this.b[b]=e;d._i=b;this.store&&(this.store[b]=a)}else{var f=this.b;c=this.store;a._i=b;e._i=d;f[d]=e;f[b]=a;c&&(e=c[b],c[b]=c[d],c[d]=e)}}return this};h.up=function(a,b){(!b||0<b)&&this.shift(a,-(b||1));return this};h.down=function(a,b){(!b||0<b)&&this.shift(a,b||1);return this};h.first=function(a){return this.shift(a,-this.length)};h.last=function(a){return this.shift(a,this.length)};
h.swap=function(a,b,d){if(a!==b){if("number"===typeof a){var c=a;a=this.b[a]}else c=a._i;if("number"===typeof b){var e=b;b=this.b[b]}else e=b._i;if(c!==e){if(this.C){var f=a._m;this.update(a,b._m,d,e);this.update(b,f,d,c)}else this.root.insertBefore(a,b),this.root.insertBefore(b,c+1===e?a:this.b[c+1]),a._i=e,b._i=c,this.b[c]=b,this.b[e]=a;this.store&&(a=this.store[e],this.store[e]=this.store[c],this.store[c]=a)}}return this};var M=window.localStorage;E.prototype.export=function(){if(this.store)var a=this.store;else if(this.o){a=Array(this.length);for(var b=0;b<this.length;b++)a[b]=this.b[b]._m}a&&M.setItem(this.v,JSON.stringify(a));return this};E.prototype.import=function(){var a=M.getItem(this.v);a&&(a=JSON.parse(a),this.w?this.store.push.apply(this.store,a):this.store=a);return this};var N=window,O=N.requestAnimationFrame,P=N.cancelAnimationFrame,Q={store:!0,loose:!0,cache:!0,async:!1,reuse:!0},R={},S={};function E(a,b,d){a.nodeType||(d=b,b=a,a=null);b||(d=a);a?this.mount(a):(this.root=this.b=null,this.length=0);this.init(b,d)}var T=E.register=function(a,b){b||(b=a,a=b.n);S[a]=b;return E},U=E.new=function(a,b,d){return new E(a,b,d)};h=E.prototype;h.mount=function(a){this.root!==a&&(this.root=a,V(this),this.b=a._d||(a._d=W(a.children)),this.length=this.b.length);return this};
h.sync=function(){this.root._d=this.b=W(this.root.children);this.length=this.b.length;return this};h.index=function(a){return a._i};h.node=function(a){return this.b[a]};h.item=function(a){return this.o?this.b[a]._m:this.store[a]};h.find=function(a){for(var b=0;b<this.length;b++)if(this.item(b)===a)return this.b[b]};h.search=function(a){a=Object.values(a).join("^");for(var b=0;b<this.length;b++)if(Object.values(this.item(b)).join("^")===a)return this.b[b]};
h.where=function(a){for(var b=Object.keys(a),d=b.length,c=[],e=0,f,g;e<this.length;e++){f=this.item(e);g=!0;for(var n=0,k;n<d;n++)if(k=b[n],f[k]!==a[k]){g=!1;break}g&&(c[c.length]=f)}return c};
h.init=function(a,b){this.D=b=b?Object.assign({},this.D||Q,b):Q;"string"===typeof a?a=S[a]:T(a);this.cache=b.cache;this.async=b.async;this.l=0;this.C=b.reuse;this.state=b.state||R;var d=b.store;d?(this.o=b.loose)?this.store=!1:(this.w="object"===typeof d,this.store=d&&(this.w?d:[])):this.o=this.store=!1;this.v!==a&&(this.v=a.n,this.B=this.g=null,this.u=!0,this.A=null,this.F=X(this,a),V(this));return this};E.once=function(a,b,d,c,e){U(a,b).render(d,c,e).destroy(!0);return E};
function V(a){if(a.root){var b=a.root._t;b!==a.v&&(a.root._t=a.v,b&&a.clear())}}function W(a){for(var b=a.length,d=Array(b),c=0,e;c<b;c++)e=a[c],e._i=c,d[c]=e;return d}h=E.prototype;h.create=function(a,b,d){var c=this.F;this.u||this.B(c._p,c.$,a,d,b);return c.cloneNode(!0)};h.refresh=function(a,b){if("number"===typeof a)return this.update(this.b[a],null,b,a);b=a;a=this.store?this.store.length:this.length;this.o&&(this.store=null);for(var d=0;d<a;d++)this.update(this.b[d],null,b,d);return this};
h.render=function(a,b,d,c){if(!c){!b||"function"!==typeof b&&"boolean"!==typeof b||(d=b,b=null);this.l&&this.cancel();if(d){var e=this;this.l=O(function(){e.l=0;e.render(a,b,null,!0);"function"===typeof d&&d()});return this}if(this.async){var f=this;return new Promise(function(k){f.l=O(function(){f.l=0;f.render(a,b,null,!0);k()})})}}if(this.u)this.b[0]||this.add();else{a?"undefined"===typeof a.length?(a=[a],c=1):c=a.length:c=this.store?this.store.length:this.length;if(!c)return this.clear();this.C||
this.clear(c);for(var g=0;g<c;g++)g<this.length?this.update(this.b[g],a?a[g]:null,b,g):this.add(a?a[g]:this.store[g],b,this.root);if(c<this.length){this.store&&!this.w&&this.store.splice(c);g=this.b.splice(c);this.length=c;c=g.length;for(var n=0;n<c;n++)this.root.removeChild(g[n])}}return this};h.add=function(a,b,d){var c=this.length;b=this.create(a,b,c);this.store?this.store[c]=a:this.o&&(b._m=a);b._i=c;(d||this.root).appendChild(b);this.b[c]=b;this.length++;return this};
h.clear=function(a){this.root._d=this.b=a?Array(a):[];this.root.textContent="";this.length=0;this.store&&!this.w&&(this.store=a?Array(a):[]);return this};h.destroy=function(a){a&&this.unload();this.F=this.B=this.g=this.root=this.b=null};h.cancel=function(){this.l&&(P(this.l),this.l=null)};h.append=function(a,b){for(var d=a.length,c=0;c<d;c++)this.add(a[c],b);return this};
h.remove=function(a){if("number"===typeof a){var b=a;a=this.b[b]}else b=a._i;this.b.splice(b,1);this.root.removeChild(a);this.length--;this.store&&!this.w&&this.store.splice(b,1);for(a=b;a<this.length;a++)this.b[a]._i=a;return this};h.replace=function(a,b,d,c){"undefined"===typeof c&&(c=a._i);d=this.create(b,d,c);this.store?this.store[c]=b:this.o&&(d._m=b);d._i=c;this.root.replaceChild(d,a);this.b[c]=d;return this};
h.update=function(a,b,d,c){this.store?b?this.store[c]=b:b=this.store[c]:this.o&&(b?a._m=b:b=a._m);this.B(a._p||aa(this,a),a.$,b,c,d);return this};function aa(a,b){for(var d=a.g.length,c={},e=Array(d),f=0;f<d;f++){var g=a.g[f],n=f,k;if(!(k=c[g])){k=b;for(var p="",v=0;v<g.length;v++){var t=g[v];p+=t;c[p]?k=c[p]:(">"===t?k=k.firstElementChild:"+"===t?k=k.nextElementSibling:"|"===t&&(k=k.firstChild),c[p]=k)}}e[n]=k}b._p=e;b.$={};return e}var Y;
function X(a,b,d,c,e){var f=document.createElement(b.t||"div");d||(d=0,c="&",Y="",a.g=[],f._p=e=[],f.$={});var g=b.s,n=b.i,k=b.x,p=b.h,v=b.a,t=b.e,w=b.c,y=b.j,m=a.g.length,r=0,q="";y&&(q+=";"+y,-1<q.indexOf("self")&&(a.g[m]=c,e[m]=f,r=2));w&&("object"===typeof w?(q+=a.cache?";v="+w[0]+";if(self._c!==v){self._c=v;self.className=v}":";self.className="+w[0],a.g[m]=c,e[m]=f,r++):f.className=w);if(v||t){var u;v&&(u=Object.keys(v));t&&(w=Object.keys(t),u=u?u.concat(w):w);for(w=0;w<u.length;w++){y=u[w];
var A=void 0;v&&"undefined"!==typeof(A=v[y])||(A=t[y],a.listen(y));if("object"===typeof A){q+=a.cache?";v="+A[0]+";if(self['_a_"+y+"']!==v){self['_a_"+y+"']=v;self.setAttribute('"+y+"',v)}":";self.setAttribute('"+y+"',"+A[0]+")";var B=!0;r++}else f.setAttribute(y,A)}B&&(a.g[m]=c,e[m]=f)}if(g)if("string"===typeof g)f.style.cssText=g;else if(g.length)q+=a.cache?";v="+g[0]+";if(self._cs!==v){self._cs=v;(self._s||(self._s=self.style)).cssText=v}":";self.style.cssText="+g[0],a.g[m]=c,e[m]=f,r++;else{v=
Object.keys(g);for(t=0;t<v.length;t++)if(u=v[t],B=g[u],"object"===typeof B){q+=a.cache?";v="+B[0]+";var t=self['_sc']||(self['_sc']={});if(t['"+u+"']!==v){t['"+u+"']=v;(self._s||(self._s=self.style)).setProperty('"+u+"',v)}":";self.style.setProperty('"+u+"',"+B[0]+")";var ba=!0;r++}else f.style.setProperty(u,B);ba&&(a.g[m]=c,e[m]=f)}n||(b["@"]?(a.A||(a.A=[]),k=Y+=";this.include["+a.A.length+"].mount(p["+m+"]).render("+b.r+(b.m?".slice("+(0<b.m?"0,":"")+b.m+")":"")+",index,view)",Y="",a.A.push(new E(f,
"string"===typeof b["@"]?S[b["@"]]:b["@"],Object.assign(a.D,{store:!1,loose:!1,async:!1}))),Y=k,a.g[m]=c,e[m]=f,a.u=!1):b["+"]?n=S[b["+"]]:k?(c+="|",(g="object"===typeof k)&&(k=k[0]),p=document.createTextNode(k),g&&(r&&(Z(r,q,m,a.cache),q="",m++),q+=a.cache?";v="+k+";if(self._x!==v){self._x=v;self.nodeValue=v}":";self.nodeValue="+k,a.g[m]=c,e[m]=p,r++),f.appendChild(p)):p&&("object"===typeof p?(p=p[0],q+=a.cache?";v="+p+";if(self._h!==v){self._h=v;self.innerHTML=v}":";self.innerHTML="+p,a.g[m]=c,
e[m]=f,r++):f.innerHTML=p));b.f&&(Y+=";if("+b.f+"){"+(1<r?"self":"p["+m+"]")+".hidden=false",r||(a.g[m]=c,e[m]=f,a.u=!1));r&&(a.u=!1,Z(r,q,m,a.cache));if(n)if(n.length)for(k=">",g=0;g<n.length;g++){g&&(k+="+");p=n[g];if(q=p["+"])p=S[q];f.appendChild(X(a,p,d+g+1,c+k,e))}else{if(q=n["+"])n=S[q];f.appendChild(X(a,n,d+1,c+">",e))}b.f&&(Y+="}else "+(1<r?"self":"p["+m+"]")+".hidden=true");d||a.u||!Y||(a.B=Function("p","s","item","index","view",'"use strict";var self,v'+Y));return f}
function Z(a,b,d,c){Y=c||1<a?Y+(";self=p["+d+"]"+b):Y+b.replace(/self/g,"p["+d+"]")}E.prototype.load=function(a,b){if(S[a])this instanceof E&&this.init(S[a]),b&&b();else{var d=this,c=new XMLHttpRequest;c.overrideMimeType("application/json");c.open("GET",a,!1!==b);c.onload=function(){var e=this.responseText;if(e){try{var f=JSON.parse(e);T(f);d instanceof E&&d.init(f)}catch(n){var g=n}"function"===typeof b&&b(g)}};c.send()}};E.load=E.prototype.load;
E.prototype.unload=function(a){a||(a=this.v);a&&(S[a]=null)};E.unload=E.prototype.unload;(function(){var a=this||window,b;(b=a.define)&&b.amd?b([],function(){return E}):(b=a.modules)?b.mikado=E:"object"===typeof a.exports?a.module.exports=E:a.Mikado=E})();}).call(this);
