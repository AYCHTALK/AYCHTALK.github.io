export{map as mini}from"./map/mini.js";import{api as r}from"./sinuous.js";const t="__g",n="nextSibling",e="previousSibling";function o(r,n,e){const o=r[t];if(o)for(r=r[n];r&&r[t]!==o;)r=r[n];return e?r:r[n]}function f(r,t,n){let e;for(;t!==n;)e=t.nextSibling,r.removeChild(t),t=e}function i(r,t,n,e){let o;for(;t!==n;)o=t.nextSibling,r.insertBefore(t,e),t=o}function u(r,t){let n=-1,e=r.length;if(e>0&&r[e-1]<=t)return e-1;for(;e-n>1;){var o=(n+e)/2|0;r[o]>t?e=o:n=o}return n}let l=0;function c(c,s){const{subscribe:a,root:m,sample:p,cleanup:b}=r,v=new Map;let d=document.createDocumentFragment();const g=d.appendChild(document.createTextNode("")),k=d.appendChild(document.createTextNode(""));function w(){v.forEach(r=>r()),v.clear()}function x(r){let t=v.get(r);t&&t(),v.delete(r)}function y(r,n,e,o,f){return m(i=>{const u=function(r,n,e,o){let f;const i=typeof n;return"string"===i||"number"===i?n=document.createTextNode(n):11===n.nodeType&&(f=n.firstChild)&&f!==n.lastChild&&(f[t]=n.lastChild[t]=o),r.insertBefore(n,e||null),f||n}(r,s(n,e,o),f,++l);return v.set(u,i),u})}return b(a(r=>{r=r||[];const t=c()||[];return p(()=>(function r(t,l,c,s,a,m,p,b){const v=c.length;if(t=a.parentNode,0===v)return s.previousSibling||a.nextSibling?f(t,s.nextSibling,a):(t.textContent="",t.appendChild(s),t.appendChild(a)),p&&p(),[];if(0===l.length){for(let r=0;r<v;r++)m(t,c[r],r,c,a);return c.slice()}let d,g,k=0,w=0,x=!0,y=l.length-1,j=v-1,A=s.nextSibling,M=A,S=a.previousSibling,_=a;r:for(;x;){let r;for(x=!1,d=l[k],g=c[w];d===g;){if(k++,w++,M=A=o(A,n),y<k||j<w)break r;d=l[k],g=c[w]}for(d=l[y],g=c[j];d===g;){if(y--,j--,S=(_=o(S,e,!0)).previousSibling,y<k||j<w)break r;d=l[y],g=c[j]}for(d=l[y],g=c[w];d===g;){x=!0;let n=o(S,e,!0);if(r=n.previousSibling,M!==n&&(i(t,n,S.nextSibling,M),S=r),w++,--y<k||j<w)break r;d=l[y],g=c[w]}for(d=l[k],g=c[j];d===g;){if(x=!0,r=o(A,n),A!==_){let n=r.previousSibling;i(t,A,r,_),_=n,A=r}if(j--,y<++k||j<w)break r;d=l[k],g=c[j]}}if(j<w){if(k<=y){let r,n;for(;k<=y;)r=(n=o(S,e,!0)).previousSibling,f(t,n,S.nextSibling),b&&b(n),S=r,y--}return c.slice()}if(y<k){if(w<=j)for(;w<=j;)m(t,c[w],w,c,_),w++;return c.slice()}const h=new Array(j+1-w);for(let r=w;r<=j;r++)h[r]=-1;const q=new Map;for(let r=w;r<=j;r++)q.set(c[r],r);let z=0,B=[];for(let r=k;r<=y;r++)q.has(l[r])?(h[q.get(l[r])]=r,z++):B.push(r);if(0===z)return r(t,r(t,l,[],s,a,m,p),c,s,a,m);const C=function(r,t){let n=[],e=[],o=-1,f=new Array(r.length);for(var i=t,l=r.length;i<l;i++){var c=r[i];if(!(c<0)){var s=u(n,c);-1!==s&&(f[i]=e[s]),s===o?(n[++o]=c,e[o]=i):c<n[s+1]&&(n[s+1]=c,e[s+1]=i)}}for(i=e[o];o>=0;i=f[i],o--)n[o]=i;return n}(h,w),D=[];let E=A;for(let r=k;r<=y;r++)D[r]=E,E=o(E,n);for(let r=0;r<B.length;r++){let e=D[B[r]];f(t,e,o(e,n)),b&&b(e)}let F,G=C.length-1;for(let r=j;r>=w;r--)C[G]===r?(_=D[h[C[G]]],G--):(-1===h[r]?F=m(t,c[r],r,c,_):i(t,F=D[h[r]],o(F,n),_),_=F);return c.slice()})(d,r,t,g,k,y,w,x))})),b(w),d}export{c as map};
